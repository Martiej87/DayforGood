<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Day for Good</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://js.stripe.com/v3/"></script>
</head>
<body>
  <header>
    <h1>ðŸŒŽ Day for Good</h1>
    <p>Donate the value of a workdayâ€”or any amount you chooseâ€”to make a difference.</p>
  </header>

  <main>
    <section class="donation-box">
      <h2>Choose your donation</h2>
      <button class="donate-btn" data-amount="500">$5 Donation</button>
      <button class="donate-btn" data-amount="8000">One Workday ($100)</button>

      <div class="custom-donation">
        <h3>Calculate from your wage</h3>
        <label for="wage">Hourly Wage ($):</label>
        <input type="number" id="wage" placeholder="e.g. 15" />
        
        <label for="hours">Hours to Donate:</label>
        <input type="number" id="hours" placeholder="e.g. 8" />

        <button id="calcBtn">Calculate & Donate</button>
        <p id="calculatedAmount"></p>
      </div>
    </section>
  </main>

  <footer>
    <p>Â© 2025 Day for Good</p>
  </footer>

  <script>
    const stripe = Stripe("pk_test_12345"); // Replace with your STRIPE PUBLISHABLE KEY

    document.querySelectorAll(".donate-btn").forEach(btn => {
      btn.addEventListener("click", () => {
        startCheckout(btn.dataset.amount);
      });
    });

    document.getElementById("calcBtn").addEventListener("click", () => {
      const wage = parseFloat(document.getElementById("wage").value) || 0;
      const hours = parseFloat(document.getElementById("hours").value) || 0;
      const total = wage * hours;

      if (total > 0) {
        document.getElementById("calculatedAmount").innerText = 
          `Youâ€™ll donate: $${total.toFixed(2)}`;
        startCheckout(Math.round(total * 100)); // cents
      } else {
        alert("Enter a valid wage and hours.");
      }
    });

    async function startCheckout(amount) {
      const res = await fetch("/create-checkout-session", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ amount })
      });
      const data = await res.json();
      const result = await stripe.redirectToCheckout({ sessionId: data.id });
      if (result.error) {
        alert(result.error.message);
      }
    }
  </script>
</body>
</html>
